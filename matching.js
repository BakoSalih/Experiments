function Matching(t,e){const o=[];for(let t=0;t<e+2;t++)o[t]=new Uint8Array(e+2);const l=e/2;let n=0;for(let e=0;e<=l;e++){const r=[];for(let t=l-e+1;t<=l+e-1;t+=2)for(let f=l-e+1;f<=l+e-1;f+=2){switch(n+=1,o[f][t]+o[f+1][t]+o[f][t+1]+o[f+1][t+1]){case 1:let e=o[f][t];o[f][t]=o[f+1][t+1],o[f+1][t+1]=e,e=o[f+1][t],o[f+1][t]=o[f][t+1],o[f][t+1]=e;break;case 2:o[f][t]=0,o[f+1][t]=0,o[f][t+1]=0,o[f+1][t+1]=0,r.push([t,f,n]);break;case 0:r.push([t,f,n])}}for(let e=0;e<r.length;e++){const l=r[e][0],n=r[e][1];if(!(o[n-1][l]||o[n+2][l]||o[n][l-1]||o[n+1][l-1])){Math.random()<t[t.length-r[e][2]]?(o[n][l]=1,o[n+1][l+1]=1):(o[n+1][l]=1,o[n][l+1]=1)}}}const r=[];for(let t=e;t>=1;t--){const l=new Uint8Array(e);for(let n=1;n<=e;n++)l[n-1]=o[t][n];r.push(l)}return r}function Reduction(t){const e=t.length,o=e/2,l=[];for(let t=0;t<e;t++)l[t]=[],l[t].length=e;for(let o=0;o<e;o++)for(let n=0;n<e;n++)0==t[o][n]?(l[o][n]=1,t[o][n]=1):l[o][n]=0;const n=Math.ceil(t.length/2),r=n*(n+1)*(2*n+1)/6,f=[];f.length=r,f.fill(1);let c=-1;for(let n=0;n<=o-1;n++)for(let o=e-2*n-2;o>=0;o-=2)for(let r=e-2*n-2;r>=0;r-=2){c+=1;const e=t[r+n][o+n],s=t[r+1+n][o+n],h=t[r+n][o+1+n],i=t[r+1+n][o+1+n],a=l[r+n][o+n],g=l[r+1+n][o+n],u=l[r+n][o+1+n],p=l[r+1+n][o+1+n];let M=a+p;const d=g+u;let w;d>M?w=e*i:M==d?(w=e*i+s*h,f[c]=e*i/w):(M=d,w=s*h,f[c]=0),l[r+n][o+n]=p-M,l[r+1+n][o+n]=u-M,l[r+n][o+1+n]=g-M,l[r+1+n][o+1+n]=a-M,t[r+n][o+n]=i/w,t[r+1+n][o+n]=h/w,t[r+n][o+1+n]=s/w,t[r+1+n][o+1+n]=e/w}return f}function gap(t,e,o,l,n,r=0,f=0,c=1){const s=t.length;if(n>0){const h=o+l-1+2*r,i=s-(e+l)-2*f-r;if(1==c)for(let e=-n;e<=n;e++)for(let o=-2*n;o<=2*n;o++)o>=-n+e&&o<=n+e&&(t[i-e][h+o]=0,t.holes[i-e][h+o]=1);else if(2==c)for(let e=-n;e<=n;e++)for(let o=-n;o<=n;o++)t[i-e][h+o]=0,t.holes[i-e][h+o]=1;else if(3==c)for(let e=-n;e<=n;e++)for(let o=-2*n;o<=2*n;o++)o>=-n+e&&o<=n+e&&(t[i-o][h+e]=0,t.holes[i-o][h+e]=1)}return t}export{Reduction,Matching,gap};