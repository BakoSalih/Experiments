function W_split(r){const n=r.length,t=[];for(var o=0;o<n;o++)t[o]=[],t[o].length=n,t[o].fill(0);for(o=0;o<n;o++)for(var s=0;s<n;s++)0==r[o][s]&&(t[o][s]=1,r[o][s]=1);return r.im=t,r}function Matching(r,n){const t=[];for(a=0;a<n+2;a++)t[a]=new Uint8Array(n+2),t[a].fill(!1);const o=n/2;let s=0;for(var a=0;a<=o;a++){for(var c=[],f=o-a+1;f<=o+a-1;f+=2)for(var e=o-a+1;e<=o+a-1;e+=2){switch(s+=1,t[e][f]+t[e+1][f]+t[e][f+1]+t[e+1][f+1]){case 1:const r=t[e][f];t[e][f]=t[e+1][f+1],t[e+1][f+1]=r;const n=t[e+1][f];t[e+1][f]=t[e][f+1],t[e][f+1]=n;break;case 2:t[e][f]=!1,t[e+1][f]=!1,t[e][f+1]=!1,t[e+1][f+1]=!1,c.push([f,e,s]);break;case 0:c.push([f,e,s])}}for(var i=0;i<c.length;i++){const n=c[i][0],o=c[i][1];if(!(t[o-1][n]||t[o+2][n]||t[o][n-1]||t[o+1][n-1])){Math.random()<r[r.length-c[i][2]]?(t[o][n]=!0,t[o+1][n+1]=!0):(t[o+1][n]=!0,t[o][n+1]=!0)}}}const h=[];for(a=n;a>=1;a--){const r=new Uint8Array(n);for(var u=1;u<=n;u++)r[u-1]=t[a][u];h.push(r)}return h}function Reduction(r,n){const t=r.length,o=t/2,s=[];for(var a=0;a<=o-1;a++)for(var c=t-2*a-2;c>=0;c-=2)for(var f=t-2*a-2;f>=0;f-=2){const t=r[f+a][c+a],o=r[f+1+a][c+a],h=r[f+a][c+1+a],u=r[f+1+a][c+1+a],l=n[f+a][c+a],v=n[f+1+a][c+a],p=n[f+a][c+1+a],g=n[f+1+a][c+1+a];var e=l+g;const d=v+p;var i=1;d>e?(i=t*u,s.push(1)):e==d?(i=t*u+o*h,s.push(t*u/i)):(e=d,i=o*h,s.push(0)),n[f+a][c+a]=g-e,n[f+1+a][c+a]=p-e,n[f+a][c+1+a]=v-e,n[f+1+a][c+1+a]=l-e,r[f+a][c+a]=u/i,r[f+1+a][c+a]=h/i,r[f+a][c+1+a]=o/i,r[f+1+a][c+1+a]=t/i}return s}function gap(r,n,t,o,s,a=0,c=0){const f=r.length;if(s>0){const e=t+o-1+2*a,i=f-(n+o)-2*c-a;for(c=-s;c<=s;c++)for(a=-2*s;a<=2*s;a++)a>=-s+c&&a<=s+c&&(r[i-c][e+a]=0,r.holes[i-c][e+a]=1)}return r}export{W_split,Reduction,Matching,gap};