function W_split(r){const n=r.length,t=[];for(var o=0;o<n;o++)t[o]=[],t[o].length=n,t[o].fill(0);for(o=0;o<n;o++)for(var a=0;a<n;a++)0==r[o][a]&&(t[o][a]=1,r[o][a]=1);return r.im=t,r}function Matching(r,n){const t=[];for(s=0;s<n+2;s++)t[s]=new Uint8Array(n+2),t[s].fill(!1);const o=n/2;let a=0;for(var s=0;s<=o;s++){for(var c=[],f=o-s+1;f<=o+s-1;f+=2)for(var e=o-s+1;e<=o+s-1;e+=2){switch(a+=1,t[e][f]+t[e+1][f]+t[e][f+1]+t[e+1][f+1]){case 1:const r=t[e][f];t[e][f]=t[e+1][f+1],t[e+1][f+1]=r;const n=t[e+1][f];t[e+1][f]=t[e][f+1],t[e][f+1]=n;break;case 2:t[e][f]=!1,t[e+1][f]=!1,t[e][f+1]=!1,t[e+1][f+1]=!1,c.push([f,e,a]);break;case 0:c.push([f,e,a])}}for(var i=0;i<c.length;i++){const n=c[i][0],o=c[i][1];if(!(t[o-1][n]||t[o+2][n]||t[o][n-1]||t[o+1][n-1])){Math.random()<r[r.length-c[i][2]]?(t[o][n]=!0,t[o+1][n+1]=!0):(t[o+1][n]=!0,t[o][n+1]=!0)}}}const h=[];for(s=n;s>=1;s--){const r=new Uint8Array(n);for(var l=1;l<=n;l++)r[l-1]=t[s][l];h.push(r)}return h}function Reduction(r,n){const t=r.length,o=t/2,a=[];for(var s=0;s<=o-1;s++)for(var c=t-2*s-2;c>=0;c-=2)for(var f=t-2*s-2;f>=0;f-=2){const t=r[f+s][c+s],o=r[f+1+s][c+s],h=r[f+s][c+1+s],l=r[f+1+s][c+1+s],u=n[f+s][c+s],v=n[f+1+s][c+s],g=n[f+s][c+1+s],p=n[f+1+s][c+1+s];var e=u+p;const d=v+g;var i=1;d>e?(i=t*l,a.push(1)):e==d?(i=t*l+o*h,a.push(t*l/i)):(e=d,i=o*h,a.push(0)),n[f+s][c+s]=p-e,n[f+1+s][c+s]=g-e,n[f+s][c+1+s]=v-e,n[f+1+s][c+1+s]=u-e,r[f+s][c+s]=l/i,r[f+1+s][c+s]=h/i,r[f+s][c+1+s]=o/i,r[f+1+s][c+1+s]=t/i}return a}function gap(r,n,t,o,a,s=0,c=0){const f=r.length,e=[];for(var i=0;i<f;i++)e[i]=[],e[i].length=f,e[i].fill(0);if(a>0){const i=t+o-1+2*s,h=f-(n+o)-2*c-s;for(c=-a;c<=a;c++)for(s=-2*a;s<=2*a;s++)s>=-a+c&&s<=a+c&&(e[h-c][i+s]=1,r[h-c][i+s]=0)}return r.holes=e,r}export{W_split,Reduction,Matching,gap};
