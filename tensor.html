<!DOCTYPE html>
<html>
<head>
  <title>TensorFlow.js Tutorial</title>

  <!-- Import TensorFlow.js -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
  <!-- Import tfjs-vis -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@1.0.2/dist/tfjs-vis.umd.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.3/pixi.min.js"></script>
  <!-- Import the main script file -->
  <!-- <script src="script.js"></script> -->

</head>

<body>

<div class="row">
  <div class="column", id="simulation">
	<div id="sim"></div>
  </div>
  <div class="column">
	<div id="in1", class="input0">n = </div>
	<div id="in2", class="input0">m = </div>
  </div>
</div>

<button onclick="myFunction()">Add</button>
<button onclick="myRemove()">Remove</button>

<script type="text/javascript">

console.log('Hello TensorFlow');


let pts = tf.randomNormal([2,1000],300,100).arraySync();
let pts2 = tf.randomNormal([2,1000],400,100).arraySync();

/*                */


let type = "WebGL"
if(!PIXI.utils.isWebGLSupported()){
  type = "canvas"
}
//Create a Pixi Application
let app = new PIXI.Application({
  width: 500,
  height: 500,
  antialias: true,
  transparent: true,
  resolution: 1
}
);

//Add the canvas that Pixi automatically created for you to the HTML document
//document.body.appendChild(app.view);
document.getElementById("sim").appendChild(app.view);


//load an image and run the `setup` function when it's done
const loader = new PIXI.Loader();
loader.load(setup(pts,pts2));


//This `setup` function will run when the image has loaded
function setup(pts,pts2) {
	let container = new PIXI.Container();
	app.stage.addChild(container);

	
	const n = pts[0].length;
	
	for (i = 0; i < n; i++) {
		let vertex = new PIXI.Graphics();
		const x = pts[0][i];
		const y = pts[1][i];
		const xcord = x/2;
		const ycord = y/2;
		vertex.beginFill(0x000000);
		vertex.drawCircle(xcord , ycord, 1);
		vertex.endFill();
		container.addChild(vertex);
	}
	
	const m = pts2[0].length;
	
	
	let container2 = new PIXI.Container();
	app.stage.addChild(container2);
	for (i = 0; i < m; i++) {
		let vertex = new PIXI.Graphics();
		const x = pts2[0][i];
		const y = pts2[1][i];
		const xcord = x/2;
		const ycord = y/2;
		vertex.beginFill(0x03BE10);
		vertex.drawCircle(xcord , ycord, 1);
		vertex.endFill();
		container2.addChild(vertex);
	}
	let d = 0;
	app.ticker.add((delta) => {
    // rotate the container!
    // use delta to create frame-independent transform
    // container.rotation -= 0.01 * delta;
	//container.x += 1 * Math.sin(delta);
	//container.x = 100*Math.sin(d);
	d += delta/30;
	shift = 100*Math.sin(d);
	//document.getElementById("first").setAttribute("value", shift);
	container.y = shift;
	container2.x = shift;
});
}

function myFunction() { 
  cl = app.stage.children;
  app.stage.removeChildren(0);
  let pts = tf.randomNormal([2,1000],50,100).arraySync();
  let pts2 = tf.randomNormal([2,1000],400,100).arraySync();
  setup(pts,pts2);
}
function myRemove() {
  cl = app.stage.children;
  app.stage.removeChildren(0);
};

var y = document.createElement("INPUT");
  y.setAttribute("type", "text");
  y.setAttribute("value", 2);
  y.setAttribute("id", "first");
  document.body.appendChild(y);
  document.getElementById("in1").appendChild(y);
  
var x = document.createElement("INPUT");
  x.setAttribute("type", "text");
  x.setAttribute("value", 8);
  x.setAttribute("id", "second");
  //document.body.appendChild(x);
  document.getElementById("in2").appendChild(x);

</script>

</body>
</html>